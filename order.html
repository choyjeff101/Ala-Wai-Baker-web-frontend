<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Order Form - AlaWaiBaker</title>
  <!-- Local Bootstrap CSS -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <!-- Optional: Custom styles -->
  <link rel="stylesheet" href="assets/css/styles.css">
  <!-- Optional: Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <style>
    /* Style for the navbar (if any customization is needed) */
    
    /* Style for the photo with overlay */
    .photo-container {
      position: relative;
      display: inline-block;
    }
    .photo-container img {
      width: 100%;
      height: auto;
    }
    .photo-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      background: rgba(0, 0, 0, 0.5);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 1rem;
    }
    /* Add a border around each grid row */
    .grid-row {
      border: 1px solid #000;
    }
    .grid-row td {
      border: none;
      padding: 10px;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <!-- Navigation Bar (from index.html) -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">The Ala Wai Baker</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
              data-bs-target="#navbarNav" aria-controls="navbarNav" 
              aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="order.html">Order</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  
  <div class="container mt-5">
    <h1>Enter Your Contact Info</h1>
    <!-- START FORM -->
    <form id="orderForm">
    <input type="hidden" name="_format" value="json">
    <!-- Personal Info Section as a 2x2 grid -->
    <div class="row">
      <!-- Row 1, Column 1: First Name -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">1. First Name:</label>
          <input type="text" class="form-control" id="firstName" placeholder="Enter your first name" required>
        </div>
      </div>
      <!-- Row 1, Column 2: Last Name -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">2. Last Name:</label>
          <input type="text" class="form-control" id="lastName" placeholder="Enter your last name" required>
        </div>
      </div>
    <div class="row">
      <!-- Row 2, Column 1: Phone Number -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">3. Phone Number:</label>
          <input type="tel" class="form-control" id="phoneNumber" placeholder="Enter 10-digit phone number" pattern="\d{10}" required>
        </div>
      </div>
      <!-- Row 2, Column 2: Date & Time -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label">4. Pickup Date & Time:</label>
          <input type="date" class="form-control mb-2" id="pickupDate" required>
          <input type="time" class="form-control" id="pickupTime" required>
        </div>
      </div>
    </div>
    
    <!-- 3x4 Product Grid Section -->
    <h2 class="mt-5">Choose your flavor and size. Mahalo!</h2>
    <table class="table">
      <tbody>
        <!-- Row 1 -->
        <tr class="grid-row">
          <!-- Column 1: Photo with faded overlay label -->
          <td>
            <div class="photo-container">
              <img src="assets/images/example.jpg" alt="Product Photo" class="img-fluid">
              <div class="photo-overlay">Example Label</div>
            </div>
          </td>
          <!-- Column 2: Fullcaccia with counter -->
          <td>
            <strong>Fullcaccia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <!-- Column 3: Halfoccaia with counter -->
          <td>
            <strong>Halfoccaia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <!-- Column 4: Special Requests input -->
          <td>
            <input type="text" class="form-control" maxlength="250" placeholder="Special Requests">
          </td>
        </tr>
        <!-- Row 2 -->
        <tr class="grid-row">
          <td>
            <div class="photo-container">
              <img src="assets/images/example.jpg" alt="Product Photo" class="img-fluid">
              <div class="photo-overlay">Example Label</div>
            </div>
          </td>
          <td>
            <strong>Fullcaccia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <td>
            <strong>Halfoccaia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <td>
            <input type="text" class="form-control" maxlength="250" placeholder="Special Requests">
          </td>
        </tr>
        <!-- Row 3 -->
        <tr class="grid-row">
          <td>
            <div class="photo-container">
              <img src="assets/images/example.jpg" alt="Product Photo" class="img-fluid">
              <div class="photo-overlay">Example Label</div>
            </div>
          </td>
          <td>
            <strong>Fullcaccia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <td>
            <strong>Halfoccaia</strong>
            <div class="d-flex align-items-center mt-2">
              <span>QTY: </span>
              <button type="button" class="btn btn-secondary ms-2 counter-btn" data-counter="0" data-max="10">0</button>
            </div>
          </td>
          <td>
            <input type="text" class="form-control" maxlength="250" placeholder="Special Requests">
          </td>
        </tr>
      </tbody>
    </table>
    
    <!-- Submit Button for the Grid (center aligned) -->
    <div class="text-center mt-4">
      <button type="submit" class="btn btn-primary">Submit Order</button>
    </div>
  </form>
  </div>

  <!-- Local Bootstrap JS -->
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script>
    // JavaScript for the clickable counter buttons.
    // Each counter starts at 0, increments by 1 on click, and resets to 0 after reaching 10.
    document.querySelectorAll('.counter-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        let current = parseInt(btn.getAttribute('data-counter'));
        const max = parseInt(btn.getAttribute('data-max'));
        current = (current + 1) % (max + 1);
        btn.setAttribute('data-counter', current);
        btn.textContent = current;
      });
    });
  </script>

<!-- Collect Values & POST -->
<script>
  const form = document.getElementById('orderForm');
  
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
  
    const data = {
      firstName: form.firstName.value,
      lastName: form.lastName.value,
      phone: form.phoneNumber.value,
      pickupDate: form.pickupDate.value,
      pickupTime: form.pickupTime.value,
      products: Array.from(document.querySelectorAll('.grid-row')).map(row => ({
        fullcacciaQty: Number(row.querySelectorAll('.counter-btn')[0].textContent),
        halfoccaiaQty: Number(row.querySelectorAll('.counter-btn')[1].textContent),
        specialRequests: row.querySelector('input[type="text"]').value.trim()
      }))
    };
  
    try {
      const resp = await fetch('https://formspree.io/f/mldjbloj', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      if (!resp.ok) throw new Error(await resp.text());
      alert('Order submitted successfully!');
      form.reset();
      // reset counters
      document.querySelectorAll('.counter-btn').forEach(btn => { btn.textContent = '0'; btn.dataset.counter = 0 });
    } catch(err) {
      alert('Error submitting order: ' + err.message);
    }
  });
  </script>
</body>
</html>
